setwd("/Volumes/6167233/6167233/NTFS_Vol_SOUMITA NUS/GoodFiles/Larry_Adrian/VOLCANO_PLOT")
setwd("/Volumes/6167233/6167233/April_24_2019/Final_TCGA_BRCA")
A = read.delim("mRNA_imputedDat_centered_rounded_73.txt", header = T, as.is = T, check.names = F)
B = read.delim("Final_TCGA_BRCA/BRCA_groupinfo_example_new.txt", header = T, as.is = T, check.names = F)
B = read.delim("BRCA_groupinfo_example_new.txt", header = T, as.is = T, check.names = F)
B1 = order(B$BRCA_subtype)
ord = order(B$BRCA_subtype)
B1 = B[ord,]
B1
dim(A)
A1 = A[,-1]
A2 = A1[,B1$SubjectID]
A1[1,1]
A1[1,]
A2[1,]
gene_vec = A2[i,]
i = 1
gene_vec = as.vector(A2[i,])
gene_vec
combined_df = data.frame(cbind(gene_vec, B1$BRCA_subtype))
View(combined_df)
B1$BRCA_subtype
subtype_vec = as.vector(B1$BRCA_subtype)
combined_df = data.frame(cbind(gene_vec, subtype_vec))
gene_vec = A2[i,]
gene_vec = t(A2[i,])
subtype_vec = t(B1$BRCA_subtype)
subtype_vec = B1$BRCA_subtype
combined_df = cbind(gene_vec, subtype_vec)
View(combined_df)
combined_df = data.frame(cbind(gene_vec, subtype_vec))
summary(combined_df)
colnames(combined_df) = c("values", "subtype")
anova_results = aov(values ~ subtype, data = combined_df)
summary(anova_results)
View(combined_df)
View(anova_results)
anova_results = aov(combined_df$values ~ combined_df$subtype, data = combined_df)
aov(combined_df$values ~ as.numeric(combined_df$subtype), data = combined_df)
aov(as.numeric(combined_df$values) ~ combined_df$subtype, data = combined_df)
gene_vec = t(A2[i,])
subtype_vec = B1$BRCA_subtype
combined_df = data.frame(cbind(gene_vec, subtype_vec))
colnames(combined_df) = c("values", "subtype")
summary(combined_df)
anova_results = aov(as.numeric(combined_df$values) ~ combined_df$subtype, data = combined_df)
summary(anova_results)
summary(anova_results)[[1]][["Pr(>F)"]]
anova_results
p_val_mat = matrix(data = NA, nrow = dim(A2)[1], ncol = 1)
anova_results$model
summary(anova_results)[[1]]
summary(anova_results)[[1]][5]
summary(anova_results)[[1]][["Pr(>F)"]]
summary(anova_results)[[1]][["Pr(>F)[1]"]]
summary(anova_results)[[1]][["Pr(>F)"[1]]]
val = summary(anova_results)[[1]][5]
val
View(val)
summary(anova_results)[[1]][["Pr(>F)"],1]
summary(anova_results)[[1]][[1, "Pr(>F)"]]
for(i in 1:dim(A2)[1]){
gene_vec = t(A2[i,])
subtype_vec = B1$BRCA_subtype
combined_df = data.frame(cbind(gene_vec, subtype_vec))
colnames(combined_df) = c("values", "subtype")
summary(combined_df)
anova_results = aov(as.numeric(combined_df$values) ~ combined_df$subtype, data = combined_df)
summary(anova_results)
p_val_mat[i] = summary(anova_results)[[1]][[1, "Pr(>F)"]]
print(i)
}
View(p_val_mat)
sum(p_val_mat[p_val_mat < 0.05])
sum(p_val_mat< 0.05)
sum(p_val_mat<= 0.05)
A = read.delim("protein_data_row_centered.txt", header = T, as.is = T, check.names = F)
B = read.delim("sample_data.txt", header = T, as.is = T, check.names = F)
setwd("/Volumes/6167233/6167233/data_from_HWC")
A = read.delim("protein_data_row_centered.txt", header = T, as.is = T, check.names = F)
B = read.delim("sample_data.txt", header = T, as.is = T, check.names = F)
ord = order(B$Group)
B1 = B[ord,]
B
B1
A2 = A1[,B1$Group]
A1 = A[,-1] ## remove the gene symbol column
A2 = A1[,B1$Group]
A2 = A1[,B1$Group]
A1[1,]
p_val_mat = matrix(data = NA, nrow = dim(A1)[1], ncol =1)
B$Group
A1[i, B$Group="IR"]
A1[1, B$Group="IR"]
A1[1, B$Group=="IR"]
i = 1
x1 = t(A1[i,B$Group=="IR"])
x2 = t(A1[i,B$Group=="IS"])
x1
x2
i = 1
x1 = t(A1[i,B$Group=="IR"])
x2 = t(A1[i,B$Group=="IS"])
ttest = t.test(x1,x2,alternative = "two.sided")
ttest$p.value
setwd("/Users/abhikdatta/code/code_multislide_03_Nov_2018/multiSLIDE/demo_data")
A = read.delim("formatted_data_RNA_Seq_v2_mRNA_median_Zscores.txt", header = T, as.is = T, check.names = F)
B = read.delim("clinical_info_blca.txt", header = T, as.is = T, check.names = F)
A1 = A[,-1]
A[1,]
A1 = A[,-c(1,2,3)]
A1[1,]
B$AGE
B[,1]
A2 = A[,B[,1]]
A2 = A[,B$PATIENT_ID]
B$PATIENT_ID
length(B$PATIENT_ID)
dim(A1)
ord = order(B$AGE)
B1 = B[ord,]
View(B1)
B1$PATIENT_ID %in% colnames(A1)
B1 = B1[B1$PATIENT_ID %in% colnames(A1),]
A2 = A[,B1$PATIENT_ID]
i = 1
gene_vec = t(A2[i,])
gene_vec
age_vec = B1$AGE
age_vec
B1[B1$PATIENT_ID=="TCGA-CF-A3MF-01", B1$AGE]
B1[B1$PATIENT_ID=="TCGA-CF-A3MF-01",]
colnames(combined_df) = c("values", "age")
combined_df = data.frame(cbind(gene_vec, age_vec))
colnames(combined_df) = c("values", "age")
linearMod <- lm(combined_df$values ~ combined_df$age, data = combined_df)
summary(linearMod)
linearMod <- lm(combined_df$age ~ combined_df$values, data = combined_df)
summary(linearMod)
summary(linearMod)[[1]]
summary(linearMod)[[2]]
glance(linearMod)
coef(summary(linearMod))[, "Pr(>|t|)"]
coef(summary(linearMod))[2, "Pr(>|t|)"]
lm_results = summary(linearMod)
lm_results$coefficients
lm_results$coefficients[2,5]
lm_results$coefficients[1,5]
lm_results$coefficients[5]
lm_results$coefficients[6]
lm_results$coefficients[8]
p_val_mat3 = matrix(data = NA, nrow = dim(A2)[1], ncol = 1)
for(i in 1:dim(A2)[1]){
gene_vec = t(A2[i,])
age_vec = B1$AGE
combined_df = data.frame(cbind(gene_vec, age_vec))
colnames(combined_df) = c("values", "age")
linearMod <- lm(combined_df$age ~ combined_df$values, data = combined_df)
lm_results = summary(linearMod)
p_val_mat3[i] = coef(summary(linearMod))[2, "Pr(>|t|)"]
print(i)
}
View(p_val_mat3)
i = 34
gene_vec = t(A2[i,])
age_vec = B1$AGE
age_vec
gene_vec
A1 = na.omit(A1)
A = read.delim("formatted_data_RNA_Seq_v2_mRNA_median_Zscores.txt", header = T, as.is = T, check.names = F)
B = read.delim("clinical_info_blca.txt", header = T, as.is = T, check.names = F)
A1 = A[,-c(1,2,3)]
A1 = na.omit(A1)
## order according to age
ord = order(B$AGE)
B1 = B[ord,]
B1 = B1[B1$PATIENT_ID %in% colnames(A1),]
A2 = A1[,B1$PATIENT_ID]
p_val_mat3 = matrix(data = NA, nrow = dim(A2)[1], ncol = 1)
for(i in 1:dim(A2)[1]){
gene_vec = t(A2[i,])
age_vec = B1$AGE
combined_df = data.frame(cbind(gene_vec, age_vec))
colnames(combined_df) = c("values", "age")
linearMod <- lm(combined_df$age ~ combined_df$values, data = combined_df)
lm_results = summary(linearMod)
p_val_mat3[i] = coef(summary(linearMod))[2, "Pr(>|t|)"]
print(i)
}
View(p_val_mat3)
setwd("/Volumes/6167233/6167233/April_24_2019/Final_TCGA_BRCA")
A = read.delim("mRNA_imputedDat_centered_rounded_73.txt", header = T, as.is = T, check.names = F)
B = read.delim("BRCA_groupinfo_example_new.txt", header = T, as.is = T, check.names = F)
## order according to subtype
ord = order(B$BRCA_subtype)
B1 = B[ord,]
A1 = A[,-1] ## remove the gene symbol column
A2 = A1[,B1$SubjectID]
p_val_mat1 = matrix(data = NA, nrow = dim(A2)[1], ncol = 1)
i=1
gene_vec = t(A2[i,])
subtype_vec = B1$BRCA_subtype
combined_df = data.frame(cbind(gene_vec, subtype_vec))
colnames(combined_df) = c("values", "subtype")
summary(combined_df)
anova_results = aov(as.numeric(combined_df$values) ~ combined_df$subtype, data = combined_df)
summary(anova_results)
p_val_mat1[i] = summary(anova_results)[[1]][[1, "Pr(>F)"]]
print(i)
combined_df
anova_results
library(dplyr)
install.packages("dplyr")
library(dplyr)
group_by(gene_vec, subtype_vec) %>%
summarise(
count = n(),
mean = mean(weight, na.rm = TRUE),
sd = sd(weight, na.rm = TRUE)
)
group_by(combined_df$values, combined_df$subtype) %>%
summarise(
count = n(),
mean = mean(weight, na.rm = TRUE),
sd = sd(weight, na.rm = TRUE)
)
for(i in 1:dim(A2)[1]){
gene_vec = t(A2[i,])
subtype_vec = B1$BRCA_subtype
combined_df = data.frame(cbind(gene_vec, subtype_vec))
colnames(combined_df) = c("values", "subtype")
summary(combined_df)
anova_results = aov(as.numeric(combined_df$values) ~ combined_df$subtype, data = combined_df)
summary(anova_results)
p_val_mat1[i] = summary(anova_results)[[1]][[1, "Pr(>F)"]]
print(i)
}
View(p_val_mat1)
p_val_mat1
i = 1
gene_vec = t(A2[i,])
subtype_vec = B1$BRCA_subtype
combined_df = data.frame(cbind(gene_vec, subtype_vec))
colnames(combined_df) = c("values", "subtype")
summary(combined_df)
anova_results = aov(as.numeric(combined_df$values) ~ combined_df$subtype, data = combined_df)
summary(anova_results)
p_val_mat1[i] = summary(anova_results)[[1]][[1, "Pr(>F)"]]
print(i)
combined_df
as.numeric(combined_df$values)
as.numeric(combined_df$values[1])
as.numeric("-1.731")
combined_df$values
combined_df$values[1]
anova_results = aov(combined_df$values ~ combined_df$subtype, data = combined_df)
anova_results = aov(as.double(combined_df$values) ~ combined_df$subtype, data = combined_df)
anova_results = aov(as.double(combined_df$values) ~ combined_df$subtype, data = combined_df)
as.double(combined_df$values)
combined_df[1]
combined_df[1,1]
combined_mat = as.matrix(cbind(gene_vec, subtype_vec))
combined_mat
as.numeric(combine_mat[,1])
as.numeric(combined_mat[,1])
anova_results = aov(as.numeric(combined_mat[,1]) ~ combined_mat[,2], data = combined_mat)
anova_results = aov(as.numeric(combined_mat[,1]) ~ combined_mat[,2], data = combined_df)
summary(anova_results)
for(i in 1:dim(A2)[1]){
gene_vec = t(A2[i,])
subtype_vec = B1$BRCA_subtype
combined_df = data.frame(cbind(gene_vec, subtype_vec))
combined_mat = as.matrix(cbind(gene_vec, subtype_vec))
colnames(combined_df) = c("values", "subtype")
summary(combined_df)
##anova_results = aov(as.double(combined_df$values) ~ combined_df$subtype, data = combined_df)
anova_results = aov(as.numeric(combined_mat[,1]) ~ combined_mat[,2], data = combined_df)
summary(anova_results)
p_val_mat1[i] = summary(anova_results)[[1]][[1, "Pr(>F)"]]
print(i)
}
View(p_val_mat1)
setwd("/Volumes/6167233/6167233/data_from_HWC")
A = read.delim("protein_data_row_centered.txt", header = T, as.is = T, check.names = F)
B = read.delim("sample_data.txt", header = T, as.is = T, check.names = F)
##order
ord = order(B$Group)
B1 = B[ord,]
A1 = A[,-1] ## remove the gene symbol column
p_val_mat2 = matrix(data = NA, nrow = dim(A1)[1], ncol =1)
for(i in 1:dim(A1)[1]){
x1 = t(A1[i,B$Group=="IR"])
x2 = t(A1[i,B$Group=="IS"])
ttest = t.test(x1,x2,alternative = "two.sided")
p_val_mat2[i] = ttest$p.value
print(i)
}
p_val_mat2
p_val_mat2[1]
p_val_mat2[1:10]
setwd("/Users/abhikdatta/code/code_multislide_03_Nov_2018/multiSLIDE/demo_data")
A = read.delim("formatted_data_RNA_Seq_v2_mRNA_median_Zscores.txt", header = T, as.is = T, check.names = F)
B = read.delim("clinical_info_blca.txt", header = T, as.is = T, check.names = F)
A1 = A[,-c(1,2,3)]
A1 = na.omit(A1)
ord = order(B$AGE)
B1 = B[ord,]
B1 = B1[B1$PATIENT_ID %in% colnames(A1),]
B1$PATIENT_ID %in% colnames(A1)
setdiff(colnames(A1),B1$PATIENT_ID)
setdiff(B1$PATIENT_ID,colnames(A1))
B1$PATIENT_ID
colnames(A1)
X1 = B1$PATIENT_ID
X2 = colnames(A1)
ord = order(B$AGE)
length(ord)
setdiff(colnames(A1),B$PATIENT_ID)
setdiff(B$PATIENT_ID,colnames(A1))
setwd("/Users/abhikdatta/code/code_multislide_03_Nov_2018/multiSLIDE/demo_data")
A = read.delim("formatted_data_RNA_Seq_v2_mRNA_median_Zscores.txt", header = T, as.is = T, check.names = F)
B = read.delim("clinical_info_blca_LR.txt", header = T, as.is = T, check.names = F)
A1 = A[,-c(1,2,3)]
A1 = na.omit(A1)
B1 = B[B$PATIENT_ID %in% colnames(A1)]
B1 = B[B$PATIENT_ID %in% colnames(A1),]
B[1,]
B[1,1]
B1[1,1]
A1[1,]
p_val_mat3 = matrix(data = NA, nrow = dim(A1)[1], ncol = 1)
p_val_mat3 = matrix(data = NA, nrow = dim(A1)[1], ncol = 1)
for(i in 1:dim(A1)[1]){
gene_vec = t(A1[i,])
age_vec = B1$AGE
combined_df = data.frame(cbind(gene_vec, age_vec))
colnames(combined_df) = c("values", "age")
linearMod <- lm(combined_df$age ~ combined_df$values, data = combined_df)
lm_results = summary(linearMod)
p_val_mat3[i] = coef(summary(linearMod))[2, "Pr(>|t|)"]
print(i)
}
View(p_val_mat3)
i = 1
gene_vec = t(A1[i,])
age_vec = B1$AGE
combined_df = data.frame(cbind(gene_vec, age_vec))
colnames(combined_df) = c("values", "age")
linearMod <- lm(combined_df$age ~ combined_df$values, data = combined_df)
lm_results = summary(linearMod)
lm_results
i = 2
gene_vec = t(A1[i,])
age_vec = B1$AGE
combined_df = data.frame(cbind(gene_vec, age_vec))
colnames(combined_df) = c("values", "age")
linearMod <- lm(combined_df$age ~ combined_df$values, data = combined_df)
lm_results = summary(linearMod)
lm_results
