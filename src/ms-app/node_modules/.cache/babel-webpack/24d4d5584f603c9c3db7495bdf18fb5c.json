{"ast":null,"code":"import _get from \"/Users/soumitaghosh/Documents/GitHub/multi-slide/src/ms-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/soumitaghosh/Documents/GitHub/multi-slide/src/ms-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _classCallCheck from \"/Users/soumitaghosh/Documents/GitHub/multi-slide/src/ms-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/soumitaghosh/Documents/GitHub/multi-slide/src/ms-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/soumitaghosh/Documents/GitHub/multi-slide/src/ms-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/soumitaghosh/Documents/GitHub/multi-slide/src/ms-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { root } from '../../util/root';\nimport { Observable } from '../../Observable';\nimport { Subscriber } from '../../Subscriber';\nimport { map } from '../../operators/map';\n\nfunction getCORSRequest() {\n  if (root.XMLHttpRequest) {\n    return new root.XMLHttpRequest();\n  } else if (!!root.XDomainRequest) {\n    return new root.XDomainRequest();\n  } else {\n    throw new Error('CORS is not supported by your browser');\n  }\n}\n\nfunction getXMLHttpRequest() {\n  if (root.XMLHttpRequest) {\n    return new root.XMLHttpRequest();\n  } else {\n    var progId;\n\n    try {\n      var progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'];\n\n      for (var i = 0; i < 3; i++) {\n        try {\n          progId = progIds[i];\n\n          if (new root.ActiveXObject(progId)) {\n            break;\n          }\n        } catch (e) {}\n      }\n\n      return new root.ActiveXObject(progId);\n    } catch (e) {\n      throw new Error('XMLHttpRequest is not supported by your browser');\n    }\n  }\n}\n\nexport function ajaxGet(url) {\n  var headers = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  return new AjaxObservable({\n    method: 'GET',\n    url: url,\n    headers: headers\n  });\n}\nexport function ajaxPost(url, body, headers) {\n  return new AjaxObservable({\n    method: 'POST',\n    url: url,\n    body: body,\n    headers: headers\n  });\n}\nexport function ajaxDelete(url, headers) {\n  return new AjaxObservable({\n    method: 'DELETE',\n    url: url,\n    headers: headers\n  });\n}\nexport function ajaxPut(url, body, headers) {\n  return new AjaxObservable({\n    method: 'PUT',\n    url: url,\n    body: body,\n    headers: headers\n  });\n}\nexport function ajaxPatch(url, body, headers) {\n  return new AjaxObservable({\n    method: 'PATCH',\n    url: url,\n    body: body,\n    headers: headers\n  });\n}\nvar mapResponse = map(function (x, index) {\n  return x.response;\n});\nexport function ajaxGetJSON(url, headers) {\n  return mapResponse(new AjaxObservable({\n    method: 'GET',\n    url: url,\n    responseType: 'json',\n    headers: headers\n  }));\n}\nexport var AjaxObservable = /*#__PURE__*/function (_Observable) {\n  _inherits(AjaxObservable, _Observable);\n\n  var _super = _createSuper(AjaxObservable);\n\n  function AjaxObservable(urlOrRequest) {\n    var _this;\n\n    _classCallCheck(this, AjaxObservable);\n\n    _this = _super.call(this);\n    var request = {\n      async: true,\n      createXHR: function createXHR() {\n        return this.crossDomain ? getCORSRequest() : getXMLHttpRequest();\n      },\n      crossDomain: true,\n      withCredentials: false,\n      headers: {},\n      method: 'GET',\n      responseType: 'json',\n      timeout: 0\n    };\n\n    if (typeof urlOrRequest === 'string') {\n      request.url = urlOrRequest;\n    } else {\n      for (var prop in urlOrRequest) {\n        if (urlOrRequest.hasOwnProperty(prop)) {\n          request[prop] = urlOrRequest[prop];\n        }\n      }\n    }\n\n    _this.request = request;\n    return _this;\n  }\n\n  _createClass(AjaxObservable, [{\n    key: \"_subscribe\",\n    value: function _subscribe(subscriber) {\n      return new AjaxSubscriber(subscriber, this.request);\n    }\n  }]);\n\n  return AjaxObservable;\n}(Observable);\n\nAjaxObservable.create = function () {\n  var create = function create(urlOrRequest) {\n    return new AjaxObservable(urlOrRequest);\n  };\n\n  create.get = ajaxGet;\n  create.post = ajaxPost;\n  create.delete = ajaxDelete;\n  create.put = ajaxPut;\n  create.patch = ajaxPatch;\n  create.getJSON = ajaxGetJSON;\n  return create;\n}();\n\nexport var AjaxSubscriber = /*#__PURE__*/function (_Subscriber) {\n  _inherits(AjaxSubscriber, _Subscriber);\n\n  var _super2 = _createSuper(AjaxSubscriber);\n\n  function AjaxSubscriber(destination, request) {\n    var _this2;\n\n    _classCallCheck(this, AjaxSubscriber);\n\n    _this2 = _super2.call(this, destination);\n    _this2.request = request;\n    _this2.done = false;\n    var headers = request.headers = request.headers || {};\n\n    if (!request.crossDomain && !_this2.getHeader(headers, 'X-Requested-With')) {\n      headers['X-Requested-With'] = 'XMLHttpRequest';\n    }\n\n    var contentTypeHeader = _this2.getHeader(headers, 'Content-Type');\n\n    if (!contentTypeHeader && !(root.FormData && request.body instanceof root.FormData) && typeof request.body !== 'undefined') {\n      headers['Content-Type'] = 'application/x-www-form-urlencoded; charset=UTF-8';\n    }\n\n    request.body = _this2.serializeBody(request.body, _this2.getHeader(request.headers, 'Content-Type'));\n\n    _this2.send();\n\n    return _this2;\n  }\n\n  _createClass(AjaxSubscriber, [{\n    key: \"next\",\n    value: function next(e) {\n      this.done = true;\n      var xhr = this.xhr,\n          request = this.request,\n          destination = this.destination;\n      var result;\n\n      try {\n        result = new AjaxResponse(e, xhr, request);\n      } catch (err) {\n        return destination.error(err);\n      }\n\n      destination.next(result);\n    }\n  }, {\n    key: \"send\",\n    value: function send() {\n      var request = this.request,\n          _this$request = this.request,\n          user = _this$request.user,\n          method = _this$request.method,\n          url = _this$request.url,\n          async = _this$request.async,\n          password = _this$request.password,\n          headers = _this$request.headers,\n          body = _this$request.body;\n\n      try {\n        var xhr = this.xhr = request.createXHR();\n        this.setupEvents(xhr, request);\n\n        if (user) {\n          xhr.open(method, url, async, user, password);\n        } else {\n          xhr.open(method, url, async);\n        }\n\n        if (async) {\n          xhr.timeout = request.timeout;\n          xhr.responseType = request.responseType;\n        }\n\n        if ('withCredentials' in xhr) {\n          xhr.withCredentials = !!request.withCredentials;\n        }\n\n        this.setHeaders(xhr, headers);\n\n        if (body) {\n          xhr.send(body);\n        } else {\n          xhr.send();\n        }\n      } catch (err) {\n        this.error(err);\n      }\n    }\n  }, {\n    key: \"serializeBody\",\n    value: function serializeBody(body, contentType) {\n      if (!body || typeof body === 'string') {\n        return body;\n      } else if (root.FormData && body instanceof root.FormData) {\n        return body;\n      }\n\n      if (contentType) {\n        var splitIndex = contentType.indexOf(';');\n\n        if (splitIndex !== -1) {\n          contentType = contentType.substring(0, splitIndex);\n        }\n      }\n\n      switch (contentType) {\n        case 'application/x-www-form-urlencoded':\n          return Object.keys(body).map(function (key) {\n            return \"\".concat(encodeURIComponent(key), \"=\").concat(encodeURIComponent(body[key]));\n          }).join('&');\n\n        case 'application/json':\n          return JSON.stringify(body);\n\n        default:\n          return body;\n      }\n    }\n  }, {\n    key: \"setHeaders\",\n    value: function setHeaders(xhr, headers) {\n      for (var key in headers) {\n        if (headers.hasOwnProperty(key)) {\n          xhr.setRequestHeader(key, headers[key]);\n        }\n      }\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(headers, headerName) {\n      for (var key in headers) {\n        if (key.toLowerCase() === headerName.toLowerCase()) {\n          return headers[key];\n        }\n      }\n\n      return undefined;\n    }\n  }, {\n    key: \"setupEvents\",\n    value: function setupEvents(xhr, request) {\n      var progressSubscriber = request.progressSubscriber;\n\n      function xhrTimeout(e) {\n        var subscriber = xhrTimeout.subscriber,\n            progressSubscriber = xhrTimeout.progressSubscriber,\n            request = xhrTimeout.request;\n\n        if (progressSubscriber) {\n          progressSubscriber.error(e);\n        }\n\n        var error;\n\n        try {\n          error = new AjaxTimeoutError(this, request);\n        } catch (err) {\n          error = err;\n        }\n\n        subscriber.error(error);\n      }\n\n      xhr.ontimeout = xhrTimeout;\n      xhrTimeout.request = request;\n      xhrTimeout.subscriber = this;\n      xhrTimeout.progressSubscriber = progressSubscriber;\n\n      if (xhr.upload && 'withCredentials' in xhr) {\n        if (progressSubscriber) {\n          var _xhrProgress2;\n\n          _xhrProgress2 = function xhrProgress(e) {\n            var _xhrProgress = _xhrProgress2,\n                progressSubscriber = _xhrProgress.progressSubscriber;\n            progressSubscriber.next(e);\n          };\n\n          if (root.XDomainRequest) {\n            xhr.onprogress = _xhrProgress2;\n          } else {\n            xhr.upload.onprogress = _xhrProgress2;\n          }\n\n          _xhrProgress2.progressSubscriber = progressSubscriber;\n        }\n\n        var _xhrError2;\n\n        _xhrError2 = function xhrError(e) {\n          var _xhrError = _xhrError2,\n              progressSubscriber = _xhrError.progressSubscriber,\n              subscriber = _xhrError.subscriber,\n              request = _xhrError.request;\n\n          if (progressSubscriber) {\n            progressSubscriber.error(e);\n          }\n\n          var error;\n\n          try {\n            error = new AjaxError('ajax error', this, request);\n          } catch (err) {\n            error = err;\n          }\n\n          subscriber.error(error);\n        };\n\n        xhr.onerror = _xhrError2;\n        _xhrError2.request = request;\n        _xhrError2.subscriber = this;\n        _xhrError2.progressSubscriber = progressSubscriber;\n      }\n\n      function xhrReadyStateChange(e) {\n        return;\n      }\n\n      xhr.onreadystatechange = xhrReadyStateChange;\n      xhrReadyStateChange.subscriber = this;\n      xhrReadyStateChange.progressSubscriber = progressSubscriber;\n      xhrReadyStateChange.request = request;\n\n      function xhrLoad(e) {\n        var subscriber = xhrLoad.subscriber,\n            progressSubscriber = xhrLoad.progressSubscriber,\n            request = xhrLoad.request;\n\n        if (this.readyState === 4) {\n          var status = this.status === 1223 ? 204 : this.status;\n          var response = this.responseType === 'text' ? this.response || this.responseText : this.response;\n\n          if (status === 0) {\n            status = response ? 200 : 0;\n          }\n\n          if (status < 400) {\n            if (progressSubscriber) {\n              progressSubscriber.complete();\n            }\n\n            subscriber.next(e);\n            subscriber.complete();\n          } else {\n            if (progressSubscriber) {\n              progressSubscriber.error(e);\n            }\n\n            var error;\n\n            try {\n              error = new AjaxError('ajax error ' + status, this, request);\n            } catch (err) {\n              error = err;\n            }\n\n            subscriber.error(error);\n          }\n        }\n      }\n\n      xhr.onload = xhrLoad;\n      xhrLoad.subscriber = this;\n      xhrLoad.progressSubscriber = progressSubscriber;\n      xhrLoad.request = request;\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      var done = this.done,\n          xhr = this.xhr;\n\n      if (!done && xhr && xhr.readyState !== 4 && typeof xhr.abort === 'function') {\n        xhr.abort();\n      }\n\n      _get(_getPrototypeOf(AjaxSubscriber.prototype), \"unsubscribe\", this).call(this);\n    }\n  }]);\n\n  return AjaxSubscriber;\n}(Subscriber);\nexport var AjaxResponse = function AjaxResponse(originalEvent, xhr, request) {\n  _classCallCheck(this, AjaxResponse);\n\n  this.originalEvent = originalEvent;\n  this.xhr = xhr;\n  this.request = request;\n  this.status = xhr.status;\n  this.responseType = xhr.responseType || request.responseType;\n  this.response = parseXhrResponse(this.responseType, xhr);\n};\n\nvar AjaxErrorImpl = function () {\n  function AjaxErrorImpl(message, xhr, request) {\n    Error.call(this);\n    this.message = message;\n    this.name = 'AjaxError';\n    this.xhr = xhr;\n    this.request = request;\n    this.status = xhr.status;\n    this.responseType = xhr.responseType || request.responseType;\n    this.response = parseXhrResponse(this.responseType, xhr);\n    return this;\n  }\n\n  AjaxErrorImpl.prototype = Object.create(Error.prototype);\n  return AjaxErrorImpl;\n}();\n\nexport var AjaxError = AjaxErrorImpl;\n\nfunction parseJson(xhr) {\n  if ('response' in xhr) {\n    return xhr.responseType ? xhr.response : JSON.parse(xhr.response || xhr.responseText || 'null');\n  } else {\n    return JSON.parse(xhr.responseText || 'null');\n  }\n}\n\nfunction parseXhrResponse(responseType, xhr) {\n  switch (responseType) {\n    case 'json':\n      return parseJson(xhr);\n\n    case 'xml':\n      return xhr.responseXML;\n\n    case 'text':\n    default:\n      return 'response' in xhr ? xhr.response : xhr.responseText;\n  }\n}\n\nfunction AjaxTimeoutErrorImpl(xhr, request) {\n  AjaxError.call(this, 'ajax timeout', xhr, request);\n  this.name = 'AjaxTimeoutError';\n  return this;\n}\n\nexport var AjaxTimeoutError = AjaxTimeoutErrorImpl;","map":{"version":3,"sources":["../../../../src/internal/observable/dom/AjaxObservable.ts"],"names":[],"mappings":"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","sourcesContent":["import { root } from '../../util/root';\nimport { Observable } from '../../Observable';\nimport { Subscriber } from '../../Subscriber';\nimport { map } from '../../operators/map';\nfunction getCORSRequest() {\n    if (root.XMLHttpRequest) {\n        return new root.XMLHttpRequest();\n    }\n    else if (!!root.XDomainRequest) {\n        return new root.XDomainRequest();\n    }\n    else {\n        throw new Error('CORS is not supported by your browser');\n    }\n}\nfunction getXMLHttpRequest() {\n    if (root.XMLHttpRequest) {\n        return new root.XMLHttpRequest();\n    }\n    else {\n        let progId;\n        try {\n            const progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'];\n            for (let i = 0; i < 3; i++) {\n                try {\n                    progId = progIds[i];\n                    if (new root.ActiveXObject(progId)) {\n                        break;\n                    }\n                }\n                catch (e) {\n                }\n            }\n            return new root.ActiveXObject(progId);\n        }\n        catch (e) {\n            throw new Error('XMLHttpRequest is not supported by your browser');\n        }\n    }\n}\nexport function ajaxGet(url, headers = null) {\n    return new AjaxObservable({ method: 'GET', url, headers });\n}\nexport function ajaxPost(url, body, headers) {\n    return new AjaxObservable({ method: 'POST', url, body, headers });\n}\nexport function ajaxDelete(url, headers) {\n    return new AjaxObservable({ method: 'DELETE', url, headers });\n}\nexport function ajaxPut(url, body, headers) {\n    return new AjaxObservable({ method: 'PUT', url, body, headers });\n}\nexport function ajaxPatch(url, body, headers) {\n    return new AjaxObservable({ method: 'PATCH', url, body, headers });\n}\nconst mapResponse = map((x, index) => x.response);\nexport function ajaxGetJSON(url, headers) {\n    return mapResponse(new AjaxObservable({\n        method: 'GET',\n        url,\n        responseType: 'json',\n        headers\n    }));\n}\nexport class AjaxObservable extends Observable {\n    constructor(urlOrRequest) {\n        super();\n        const request = {\n            async: true,\n            createXHR: function () {\n                return this.crossDomain ? getCORSRequest() : getXMLHttpRequest();\n            },\n            crossDomain: true,\n            withCredentials: false,\n            headers: {},\n            method: 'GET',\n            responseType: 'json',\n            timeout: 0\n        };\n        if (typeof urlOrRequest === 'string') {\n            request.url = urlOrRequest;\n        }\n        else {\n            for (const prop in urlOrRequest) {\n                if (urlOrRequest.hasOwnProperty(prop)) {\n                    request[prop] = urlOrRequest[prop];\n                }\n            }\n        }\n        this.request = request;\n    }\n    _subscribe(subscriber) {\n        return new AjaxSubscriber(subscriber, this.request);\n    }\n}\nAjaxObservable.create = (() => {\n    const create = (urlOrRequest) => {\n        return new AjaxObservable(urlOrRequest);\n    };\n    create.get = ajaxGet;\n    create.post = ajaxPost;\n    create.delete = ajaxDelete;\n    create.put = ajaxPut;\n    create.patch = ajaxPatch;\n    create.getJSON = ajaxGetJSON;\n    return create;\n})();\nexport class AjaxSubscriber extends Subscriber {\n    constructor(destination, request) {\n        super(destination);\n        this.request = request;\n        this.done = false;\n        const headers = request.headers = request.headers || {};\n        if (!request.crossDomain && !this.getHeader(headers, 'X-Requested-With')) {\n            headers['X-Requested-With'] = 'XMLHttpRequest';\n        }\n        let contentTypeHeader = this.getHeader(headers, 'Content-Type');\n        if (!contentTypeHeader && !(root.FormData && request.body instanceof root.FormData) && typeof request.body !== 'undefined') {\n            headers['Content-Type'] = 'application/x-www-form-urlencoded; charset=UTF-8';\n        }\n        request.body = this.serializeBody(request.body, this.getHeader(request.headers, 'Content-Type'));\n        this.send();\n    }\n    next(e) {\n        this.done = true;\n        const { xhr, request, destination } = this;\n        let result;\n        try {\n            result = new AjaxResponse(e, xhr, request);\n        }\n        catch (err) {\n            return destination.error(err);\n        }\n        destination.next(result);\n    }\n    send() {\n        const { request, request: { user, method, url, async, password, headers, body } } = this;\n        try {\n            const xhr = this.xhr = request.createXHR();\n            this.setupEvents(xhr, request);\n            if (user) {\n                xhr.open(method, url, async, user, password);\n            }\n            else {\n                xhr.open(method, url, async);\n            }\n            if (async) {\n                xhr.timeout = request.timeout;\n                xhr.responseType = request.responseType;\n            }\n            if ('withCredentials' in xhr) {\n                xhr.withCredentials = !!request.withCredentials;\n            }\n            this.setHeaders(xhr, headers);\n            if (body) {\n                xhr.send(body);\n            }\n            else {\n                xhr.send();\n            }\n        }\n        catch (err) {\n            this.error(err);\n        }\n    }\n    serializeBody(body, contentType) {\n        if (!body || typeof body === 'string') {\n            return body;\n        }\n        else if (root.FormData && body instanceof root.FormData) {\n            return body;\n        }\n        if (contentType) {\n            const splitIndex = contentType.indexOf(';');\n            if (splitIndex !== -1) {\n                contentType = contentType.substring(0, splitIndex);\n            }\n        }\n        switch (contentType) {\n            case 'application/x-www-form-urlencoded':\n                return Object.keys(body).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(body[key])}`).join('&');\n            case 'application/json':\n                return JSON.stringify(body);\n            default:\n                return body;\n        }\n    }\n    setHeaders(xhr, headers) {\n        for (let key in headers) {\n            if (headers.hasOwnProperty(key)) {\n                xhr.setRequestHeader(key, headers[key]);\n            }\n        }\n    }\n    getHeader(headers, headerName) {\n        for (let key in headers) {\n            if (key.toLowerCase() === headerName.toLowerCase()) {\n                return headers[key];\n            }\n        }\n        return undefined;\n    }\n    setupEvents(xhr, request) {\n        const progressSubscriber = request.progressSubscriber;\n        function xhrTimeout(e) {\n            const { subscriber, progressSubscriber, request } = xhrTimeout;\n            if (progressSubscriber) {\n                progressSubscriber.error(e);\n            }\n            let error;\n            try {\n                error = new AjaxTimeoutError(this, request);\n            }\n            catch (err) {\n                error = err;\n            }\n            subscriber.error(error);\n        }\n        xhr.ontimeout = xhrTimeout;\n        xhrTimeout.request = request;\n        xhrTimeout.subscriber = this;\n        xhrTimeout.progressSubscriber = progressSubscriber;\n        if (xhr.upload && 'withCredentials' in xhr) {\n            if (progressSubscriber) {\n                let xhrProgress;\n                xhrProgress = function (e) {\n                    const { progressSubscriber } = xhrProgress;\n                    progressSubscriber.next(e);\n                };\n                if (root.XDomainRequest) {\n                    xhr.onprogress = xhrProgress;\n                }\n                else {\n                    xhr.upload.onprogress = xhrProgress;\n                }\n                xhrProgress.progressSubscriber = progressSubscriber;\n            }\n            let xhrError;\n            xhrError = function (e) {\n                const { progressSubscriber, subscriber, request } = xhrError;\n                if (progressSubscriber) {\n                    progressSubscriber.error(e);\n                }\n                let error;\n                try {\n                    error = new AjaxError('ajax error', this, request);\n                }\n                catch (err) {\n                    error = err;\n                }\n                subscriber.error(error);\n            };\n            xhr.onerror = xhrError;\n            xhrError.request = request;\n            xhrError.subscriber = this;\n            xhrError.progressSubscriber = progressSubscriber;\n        }\n        function xhrReadyStateChange(e) {\n            return;\n        }\n        xhr.onreadystatechange = xhrReadyStateChange;\n        xhrReadyStateChange.subscriber = this;\n        xhrReadyStateChange.progressSubscriber = progressSubscriber;\n        xhrReadyStateChange.request = request;\n        function xhrLoad(e) {\n            const { subscriber, progressSubscriber, request } = xhrLoad;\n            if (this.readyState === 4) {\n                let status = this.status === 1223 ? 204 : this.status;\n                let response = (this.responseType === 'text' ? (this.response || this.responseText) : this.response);\n                if (status === 0) {\n                    status = response ? 200 : 0;\n                }\n                if (status < 400) {\n                    if (progressSubscriber) {\n                        progressSubscriber.complete();\n                    }\n                    subscriber.next(e);\n                    subscriber.complete();\n                }\n                else {\n                    if (progressSubscriber) {\n                        progressSubscriber.error(e);\n                    }\n                    let error;\n                    try {\n                        error = new AjaxError('ajax error ' + status, this, request);\n                    }\n                    catch (err) {\n                        error = err;\n                    }\n                    subscriber.error(error);\n                }\n            }\n        }\n        xhr.onload = xhrLoad;\n        xhrLoad.subscriber = this;\n        xhrLoad.progressSubscriber = progressSubscriber;\n        xhrLoad.request = request;\n    }\n    unsubscribe() {\n        const { done, xhr } = this;\n        if (!done && xhr && xhr.readyState !== 4 && typeof xhr.abort === 'function') {\n            xhr.abort();\n        }\n        super.unsubscribe();\n    }\n}\nexport class AjaxResponse {\n    constructor(originalEvent, xhr, request) {\n        this.originalEvent = originalEvent;\n        this.xhr = xhr;\n        this.request = request;\n        this.status = xhr.status;\n        this.responseType = xhr.responseType || request.responseType;\n        this.response = parseXhrResponse(this.responseType, xhr);\n    }\n}\nconst AjaxErrorImpl = (() => {\n    function AjaxErrorImpl(message, xhr, request) {\n        Error.call(this);\n        this.message = message;\n        this.name = 'AjaxError';\n        this.xhr = xhr;\n        this.request = request;\n        this.status = xhr.status;\n        this.responseType = xhr.responseType || request.responseType;\n        this.response = parseXhrResponse(this.responseType, xhr);\n        return this;\n    }\n    AjaxErrorImpl.prototype = Object.create(Error.prototype);\n    return AjaxErrorImpl;\n})();\nexport const AjaxError = AjaxErrorImpl;\nfunction parseJson(xhr) {\n    if ('response' in xhr) {\n        return xhr.responseType ? xhr.response : JSON.parse(xhr.response || xhr.responseText || 'null');\n    }\n    else {\n        return JSON.parse(xhr.responseText || 'null');\n    }\n}\nfunction parseXhrResponse(responseType, xhr) {\n    switch (responseType) {\n        case 'json':\n            return parseJson(xhr);\n        case 'xml':\n            return xhr.responseXML;\n        case 'text':\n        default:\n            return ('response' in xhr) ? xhr.response : xhr.responseText;\n    }\n}\nfunction AjaxTimeoutErrorImpl(xhr, request) {\n    AjaxError.call(this, 'ajax timeout', xhr, request);\n    this.name = 'AjaxTimeoutError';\n    return this;\n}\nexport const AjaxTimeoutError = AjaxTimeoutErrorImpl;\n//# sourceMappingURL=AjaxObservable.js.map"]},"metadata":{},"sourceType":"module"}